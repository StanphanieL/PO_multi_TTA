[Conditioning] source=auto
[Cluster] cluster_norm=True -> Predicted clusters available for per-cluster metrics.
Test samples: 1312
[Conditioning][Summary] used_cluster=1312/1312, used_true=0, used_unconditional=0
[Cluster-Class][Confusion] valid=1312 classes=40 clusters=40
[Cluster-Class][Index-consistency] diag_frac=0.9748 (assuming cluster_id == class_id)
  cluster 0 -> class 0 hit=29/29 (100.00%)
  cluster 1 -> class 1 hit=29/29 (100.00%)
  cluster 2 -> class 2 hit=29/29 (100.00%)
  cluster 3 -> class 3 hit=34/34 (100.00%)
  cluster 4 -> class 4 hit=36/36 (100.00%)
  cluster 5 -> class 5 hit=33/33 (100.00%)
  cluster 6 -> class 6 hit=33/33 (100.00%)
  cluster 7 -> class 7 hit=33/33 (100.00%)
  cluster 8 -> class 8 hit=33/33 (100.00%)
  cluster 9 -> class 9 hit=33/33 (100.00%)
  cluster 10 -> class 10 hit=34/34 (100.00%)
  cluster 11 -> class 11 hit=34/34 (100.00%)
  cluster 12 -> class 12 hit=36/36 (100.00%)
  cluster 13 -> class 13 hit=33/33 (100.00%)
  cluster 14 -> class 14 hit=34/34 (100.00%)
  cluster 15 -> class 15 hit=34/34 (100.00%)
  cluster 16 -> class 16 hit=34/34 (100.00%)
  cluster 17 -> class 17 hit=29/29 (100.00%)
  cluster 18 -> class 18 hit=29/30 (96.67%)
  cluster 19 -> class 19 hit=29/29 (100.00%)
  cluster 20 -> class 20 hit=30/30 (100.00%)
  cluster 21 -> class 21 hit=29/29 (100.00%)
  cluster 22 -> class 22 hit=38/38 (100.00%)
  cluster 23 -> class 23 hit=29/29 (100.00%)
  cluster 24 -> class 24 hit=38/38 (100.00%)
  cluster 25 -> class 25 hit=37/37 (100.00%)
  cluster 26 -> class 33 hit=16/30 (53.33%)
  cluster 27 -> class 27 hit=29/29 (100.00%)
  cluster 28 -> class 28 hit=38/38 (100.00%)
  cluster 29 -> class 29 hit=37/37 (100.00%)
  cluster 30 -> class 30 hit=33/33 (100.00%)
  cluster 31 -> class 31 hit=31/31 (100.00%)
  cluster 32 -> class 32 hit=29/29 (100.00%)
  cluster 33 -> class 26 hit=15/28 (53.57%)
  cluster 34 -> class 34 hit=37/37 (100.00%)
  cluster 35 -> class 35 hit=37/37 (100.00%)
  cluster 36 -> class 36 hit=29/30 (96.67%)
  cluster 37 -> class 37 hit=29/29 (100.00%)
  cluster 38 -> class 38 hit=37/37 (100.00%)
  cluster 39 -> class 39 hit=37/37 (100.00%)
[TTA] methods=geom(2)
[TTA-Time] pre_infer_total=495.9456s, per_sample=0.3780s
[TTA-Time] geom_infer_total=999.5080s, per_sample=0.7618s
[Global-preTTA] object AUC-ROC: 0.7748618913857679, point AUC-ROC: 0.9165817659830504, object AUCP-PR: 0.8345488579270315, point AUCP-PR: 0.3946944496245454
[Global-postTTA] object AUC-ROC: 0.7940191947565544, point AUC-ROC: 0.9336879003621574, object AUCP-PR: 0.847783365611511, point AUCP-PR: 0.4414068971550206
[Sample-macro] point AP (macro over samples) = 0.5418571276980135

[Per-Cluster metrics with cluster-wise mad normalization]
  [cluster 0] N=29 objAUC=0.9190476190476191 ptAUC=0.8979862631152508 objAP=0.935034013605442 ptAP=0.44185781437640337 pos_rate=0.046011
  [cluster 1] N=29 objAUC=0.8285714285714286 ptAUC=0.9605968287734068 objAP=0.8473351776608078 ptAP=0.49455019946441525 pos_rate=0.010704
  [cluster 2] N=29 objAUC=0.942857142857143 ptAUC=0.9839985753351765 objAP=0.9368738404452688 ptAP=0.7493463852436478 pos_rate=0.014816
  [cluster 3] N=34 objAUC=0.9438596491228071 ptAUC=0.9561341916757301 objAP=0.9471316502826197 ptAP=0.4907416036102914 pos_rate=0.014521
  [cluster 4] N=36 objAUC=0.7682539682539682 ptAUC=0.9390137408698318 objAP=0.8668753061278494 ptAP=0.6015051801743262 pos_rate=0.010945
  [cluster 5] N=33 objAUC=0.7 ptAUC=0.9607370721791911 objAP=0.7834181865280898 ptAP=0.4138099571774757 pos_rate=0.024238
  [cluster 6] N=33 objAUC=0.8296296296296295 ptAUC=0.9354416385164258 objAP=0.8949888074888075 ptAP=0.5878931587531525 pos_rate=0.005272
  [cluster 7] N=33 objAUC=0.9407407407407407 ptAUC=0.9767143853288894 objAP=0.9561678290844958 ptAP=0.7891412741714465 pos_rate=0.008974
  [cluster 8] N=33 objAUC=0.8148148148148149 ptAUC=0.9153693293399342 objAP=0.8876809459194026 ptAP=0.5100165574049078 pos_rate=0.005240
  [cluster 9] N=33 objAUC=0.9185185185185185 ptAUC=0.9752926816143942 objAP=0.95176585555525 ptAP=0.7771395100744602 pos_rate=0.008550
  [cluster 10] N=34 objAUC=0.7859649122807018 ptAUC=0.9648190496750175 objAP=0.8689646520575931 ptAP=0.5726889576875451 pos_rate=0.009434
  [cluster 11] N=34 objAUC=0.8421052631578947 ptAUC=0.9121292766537986 objAP=0.901198627224169 ptAP=0.471335909600497 pos_rate=0.022904
  [cluster 12] N=36 objAUC=0.8349206349206348 ptAUC=0.9633561143228601 objAP=0.9042942868076356 ptAP=0.629608424576891 pos_rate=0.019210
  [cluster 13] N=33 objAUC=0.8629629629629628 ptAUC=0.939447444245605 objAP=0.910433048203946 ptAP=0.4661753800523806 pos_rate=0.033391
  [cluster 14] N=34 objAUC=0.9052631578947369 ptAUC=0.968065799082195 objAP=0.9328235681421277 ptAP=0.6315806039085105 pos_rate=0.007278
  [cluster 15] N=34 objAUC=0.7824561403508772 ptAUC=0.9578461478357919 objAP=0.8761576786258449 ptAP=0.5139511991882377 pos_rate=0.006203
  [cluster 16] N=34 objAUC=0.7543859649122807 ptAUC=0.9622385317975849 objAP=0.8364109397216666 ptAP=0.5040402345075287 pos_rate=0.006009
  [cluster 17] N=29 objAUC=0.8761904761904762 ptAUC=0.9438367104396851 objAP=0.9107590404582884 ptAP=0.365288969716151 pos_rate=0.017954
  [cluster 18] N=30 objAUC=0.8044444444444445 ptAUC=0.910582024945535 objAP=0.8686010480747322 ptAP=0.40474205970116317 pos_rate=0.012529
  [cluster 19] N=29 objAUC=0.980952380952381 ptAUC=0.9774387082022636 objAP=0.984126984126984 ptAP=0.7430171756426214 pos_rate=0.019884
  [cluster 20] N=30 objAUC=0.9777777777777777 ptAUC=0.8962460659994214 objAP=0.9759432234432233 ptAP=0.43943174044228905 pos_rate=0.026679
  [cluster 21] N=29 objAUC=0.8666666666666667 ptAUC=0.912368006278637 objAP=0.8716881158057628 ptAP=0.19517032960936403 pos_rate=0.017620
  [cluster 22] N=38 objAUC=0.7014492753623188 ptAUC=0.9043517981314663 objAP=0.8000971634650597 ptAP=0.4373521738187445 pos_rate=0.018304
  [cluster 23] N=29 objAUC=0.8761904761904762 ptAUC=0.9187401642529984 objAP=0.8661468335340514 ptAP=0.1967960663902499 pos_rate=0.014613
  [cluster 24] N=38 objAUC=0.8492753623188405 ptAUC=0.9472365067933226 objAP=0.9251998822641485 ptAP=0.6149297783261879 pos_rate=0.006283
  [cluster 25] N=37 objAUC=0.6272727272727272 ptAUC=0.8249403655834122 objAP=0.7542685633150938 ptAP=0.18120093209737265 pos_rate=0.013238
  [cluster 26] N=30 objAUC=0.9502262443438915 ptAUC=0.9676649828211733 objAP=0.9647435897435894 ptAP=0.671502721366796 pos_rate=0.008856
  [cluster 27] N=29 objAUC=0.719047619047619 ptAUC=0.8687348003938528 objAP=0.7024129930092087 ptAP=0.20557211597447078 pos_rate=0.028549
  [cluster 28] N=38 objAUC=0.5942028985507246 ptAUC=0.7982459512935065 objAP=0.7540153610845653 ptAP=0.2749799671815361 pos_rate=0.012866
  [cluster 29] N=37 objAUC=0.6393939393939393 ptAUC=0.8494946237416533 objAP=0.8180460631998063 ptAP=0.4498448092942018 pos_rate=0.021178
  [cluster 30] N=33 objAUC=0.6296296296296297 ptAUC=0.7731323404882722 objAP=0.7013401435264033 ptAP=0.21206300493942884 pos_rate=0.011334
  [cluster 31] N=31 objAUC=0.9833333333333334 ptAUC=0.9804600102677213 objAP=0.9837863270308124 ptAP=0.6741344069056014 pos_rate=0.022079
  [cluster 32] N=29 objAUC=0.7714285714285715 ptAUC=0.8801512017090478 objAP=0.8458239134401053 ptAP=0.27808174091150106 pos_rate=0.008025
  [cluster 33] N=28 objAUC=0.9794871794871794 ptAUC=0.981817841279024 objAP=0.9844444444444445 ptAP=0.7478056085879918 pos_rate=0.013900
  [cluster 34] N=37 objAUC=0.7939393939393941 ptAUC=0.894625843770955 objAP=0.8901828579709379 ptAP=0.4354810343520164 pos_rate=0.017268
  [cluster 35] N=37 objAUC=0.6272727272727272 ptAUC=0.9483044313537227 objAP=0.7857734488141379 ptAP=0.3419017903590358 pos_rate=0.005107
  [cluster 36] N=30 objAUC=0.72 ptAUC=0.9316229272917904 objAP=0.8225188391855058 ptAP=0.4946413633477475 pos_rate=0.009659
  [cluster 37] N=29 objAUC=0.9666666666666668 ptAUC=0.9915732533189731 objAP=0.969108669108669 ptAP=0.6465152866851054 pos_rate=0.006073
  [cluster 38] N=37 objAUC=0.8090909090909091 ptAUC=0.9693863607716157 objAP=0.9047453409665684 ptAP=0.8479931740093702 pos_rate=0.007699
  [cluster 39] N=37 objAUC=0.9363636363636364 ptAUC=0.9736565484543651 objAP=0.9612036999807896 ptAP=0.7828215334092512 pos_rate=0.008288
  [cluster-macro] objAUC=0.8263663720940272 ptAUC=0.9303449634485876 objAP=0.8820632739868476 ptAP=0.5071662533260078

[Per-Category metrics (by true category) with category-wise mad normalization]
  [cat 0] N=29 objAUC=0.9190476190476191 ptAUC=0.8979862631152508 objAP=0.935034013605442 ptAP=0.44185781437640337 pos_rate=0.046011
  [cat 1] N=29 objAUC=0.8285714285714286 ptAUC=0.9605968287734068 objAP=0.8473351776608078 ptAP=0.49455019946441525 pos_rate=0.010704
  [cat 2] N=29 objAUC=0.942857142857143 ptAUC=0.9839985753351765 objAP=0.9368738404452688 ptAP=0.7493463852436478 pos_rate=0.014816
  [cat 3] N=34 objAUC=0.9438596491228071 ptAUC=0.9561341916757301 objAP=0.9471316502826197 ptAP=0.4907416036102914 pos_rate=0.014521
  [cat 4] N=36 objAUC=0.7682539682539682 ptAUC=0.9390137408698318 objAP=0.8668753061278494 ptAP=0.6015051801743262 pos_rate=0.010945
  [cat 5] N=33 objAUC=0.7 ptAUC=0.9607370721791911 objAP=0.7834181865280898 ptAP=0.4138099571774757 pos_rate=0.024238
  [cat 6] N=33 objAUC=0.8296296296296295 ptAUC=0.9354416385164258 objAP=0.8949888074888075 ptAP=0.5878931587531525 pos_rate=0.005272
  [cat 7] N=33 objAUC=0.9407407407407407 ptAUC=0.9767143853288894 objAP=0.9561678290844958 ptAP=0.7891412741714465 pos_rate=0.008974
  [cat 8] N=33 objAUC=0.8148148148148149 ptAUC=0.9153693293399342 objAP=0.8876809459194026 ptAP=0.5100165574049078 pos_rate=0.005240
  [cat 9] N=33 objAUC=0.9185185185185185 ptAUC=0.9752926816143942 objAP=0.95176585555525 ptAP=0.7771395100744602 pos_rate=0.008550
  [cat 10] N=34 objAUC=0.7859649122807018 ptAUC=0.9648190496750175 objAP=0.8689646520575931 ptAP=0.5726889576875451 pos_rate=0.009434
  [cat 11] N=36 objAUC=0.7841269841269841 ptAUC=0.910802438549611 objAP=0.8772925300656396 ptAP=0.46484676743085107 pos_rate=0.020688
  [cat 12] N=36 objAUC=0.8349206349206348 ptAUC=0.9633561143228601 objAP=0.9042942868076356 ptAP=0.629608424576891 pos_rate=0.019210
  [cat 13] N=33 objAUC=0.8629629629629628 ptAUC=0.939447444245605 objAP=0.910433048203946 ptAP=0.4661753800523806 pos_rate=0.033391
  [cat 14] N=34 objAUC=0.9052631578947369 ptAUC=0.968065799082195 objAP=0.9328235681421277 ptAP=0.6315806039085105 pos_rate=0.007278
  [cat 15] N=34 objAUC=0.7824561403508772 ptAUC=0.9578461478357919 objAP=0.8761576786258449 ptAP=0.5139511991882377 pos_rate=0.006203
  [cat 16] N=34 objAUC=0.7543859649122807 ptAUC=0.9622385317975849 objAP=0.8364109397216666 ptAP=0.5040402345075287 pos_rate=0.006009
  [cat 17] N=29 objAUC=0.8761904761904762 ptAUC=0.9438367104396851 objAP=0.9107590404582884 ptAP=0.365288969716151 pos_rate=0.017954
  [cat 18] N=29 objAUC=0.861904761904762 ptAUC=0.9159461267343804 objAP=0.8949296943657845 ptAP=0.4113699884226757 pos_rate=0.013043
  [cat 19] N=29 objAUC=0.980952380952381 ptAUC=0.9774387082022636 objAP=0.984126984126984 ptAP=0.7430171756426214 pos_rate=0.019884
  [cat 20] N=30 objAUC=0.9777777777777777 ptAUC=0.8962460659994214 objAP=0.9759432234432233 ptAP=0.43943174044228905 pos_rate=0.026679
  [cat 21] N=29 objAUC=0.8666666666666667 ptAUC=0.912368006278637 objAP=0.8716881158057628 ptAP=0.19517032960936403 pos_rate=0.017620
  [cat 22] N=38 objAUC=0.7014492753623188 ptAUC=0.9043517981314663 objAP=0.8000971634650597 ptAP=0.4373521738187445 pos_rate=0.018304
  [cat 23] N=29 objAUC=0.8761904761904762 ptAUC=0.9187401642529984 objAP=0.8661468335340514 ptAP=0.1967960663902499 pos_rate=0.014613
  [cat 24] N=38 objAUC=0.8492753623188405 ptAUC=0.9472365067933226 objAP=0.9251998822641485 ptAP=0.6149297783261879 pos_rate=0.006283
  [cat 25] N=37 objAUC=0.6272727272727272 ptAUC=0.8249403655834122 objAP=0.7542685633150938 ptAP=0.18120093209737265 pos_rate=0.013238
  [cat 26] N=29 objAUC=0.9523809523809524 ptAUC=0.9734894499727929 objAP=0.9669476486246671 ptAP=0.7050513165034477 pos_rate=0.014029
  [cat 27] N=29 objAUC=0.719047619047619 ptAUC=0.8687348003938528 objAP=0.7024129930092087 ptAP=0.20557211597447078 pos_rate=0.028549
  [cat 28] N=38 objAUC=0.5942028985507246 ptAUC=0.7982459512935065 objAP=0.7540153610845653 ptAP=0.2749799671815361 pos_rate=0.012866
  [cat 29] N=37 objAUC=0.6393939393939393 ptAUC=0.8494946237416533 objAP=0.8180460631998063 ptAP=0.4498448092942018 pos_rate=0.021178
  [cat 30] N=33 objAUC=0.6296296296296297 ptAUC=0.7731323404882722 objAP=0.7013401435264033 ptAP=0.21206300493942884 pos_rate=0.011334
  [cat 31] N=31 objAUC=0.9833333333333334 ptAUC=0.9804600102677213 objAP=0.9837863270308124 ptAP=0.6741344069056014 pos_rate=0.022079
  [cat 32] N=29 objAUC=0.7714285714285715 ptAUC=0.8801512017090478 objAP=0.8458239134401053 ptAP=0.27808174091150106 pos_rate=0.008025
  [cat 33] N=29 objAUC=0.980952380952381 ptAUC=0.9822387707267707 objAP=0.984126984126984 ptAP=0.742111230428872 pos_rate=0.008483
  [cat 34] N=37 objAUC=0.7939393939393941 ptAUC=0.894625843770955 objAP=0.8901828579709379 ptAP=0.4354810343520164 pos_rate=0.017268
  [cat 35] N=37 objAUC=0.6272727272727272 ptAUC=0.9483044313537227 objAP=0.7857734488141379 ptAP=0.3419017903590358 pos_rate=0.005107
  [cat 36] N=29 objAUC=0.7190476190476192 ptAUC=0.9345089005968457 objAP=0.8230234315948601 ptAP=0.5002477209609302 pos_rate=0.010180
  [cat 37] N=29 objAUC=0.9666666666666668 ptAUC=0.9915732533189731 objAP=0.969108669108669 ptAP=0.6465152866851054 pos_rate=0.006073
  [cat 38] N=37 objAUC=0.8090909090909091 ptAUC=0.9693863607716157 objAP=0.9047453409665684 ptAP=0.8479931740093702 pos_rate=0.007699
  [cat 39] N=37 objAUC=0.9363636363636364 ptAUC=0.9736565484543651 objAP=0.9612036999807896 ptAP=0.7828215334092512 pos_rate=0.008288
  [category-macro] objAUC=0.8264201112685094 ptAUC=0.9306741792883144 objAP=0.882183617489485 ptAP=0.5080062373545724
[Metrics CSV] failed to save: local variable 'gt_all' referenced before assignment
